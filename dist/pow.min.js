/**
 * @license MIT
 * @author IFYates <https://github.com/ifyates/pow.js>
 * @description A very small and lightweight templating framework.
 * @version 1.4.1
 */
let e=(e,t=["if","ifnot","item","array","template"])=>{for(let r of t.filter((t=>e.hasAttribute(t)))){let t=e.getAttribute(r);return e.removeAttribute(r),{attr:r,expr:t}}return 0},t=(e,t)=>(e.content??e).querySelectorAll(t),r=(e,t)=>i(e.replace(/{{\s*(.*?)\s*}}/gs,((e,r)=>n(r,t)??"")),t.root==t.data),n=(e,t,r=e)=>{try{let n="*"==e[0]&&(r=e.slice(1))?t:t.data,o=s._eval(r,n);if("function"==typeof o){let e=Math.random();return window[t.id][e]=e=>o.call(e,t.data,t.root),`${t.id}[${e}](this)`}return o}catch(r){console.warn("Interpolation failed",{"*path":t.path,expr:e},r)}},o=(t,r)=>{if(t?.attributes.pow){let{attr:n,expr:o}=e(t,["else-if","else-ifnot","else"]);if(n&&r)return!t.remove();n&&"else"!=n&&t.setAttribute(n.slice(5),o)}},a=(e,t,r)=>{for(;o(e.nextElementSibling,t););return(r||!t)&&e.remove()},i=(e,t)=>t?e:e.replace(/({|p)({|ow)/g,"$1​$2​"),l=(o,p,s)=>{let{attr:f,expr:u}=e(o);if("template"==f&&(s=document.getElementById(u))){let e=s.cloneNode(1);return o.parentNode.replaceChild(e,o),l(e,p)}if(s=u?n(u,p):p.data,"if"==f||"ifnot"==f)return a(o,"if"==f!=!s);if("item"==f&&u){if(null==s)return o.remove();p={...p,path:`${p.path}.${u}`,data:s,parent:p.data}}else if("array"==f){s=!s||Array.isArray(s)?s:Object.entries(s).map((([e,t])=>({key:e,value:t})));for(let e=0;e<s?.length;++e){let t=o.cloneNode(1);o.parentNode.insertBefore(t,o),l(t,{...p,path:`${p.path}${u?`.${u}`:""}[${e}]`,index:e,first:!e,last:e>s.length-2,data:s[e],parent:p})}return a(o,s?.length,1)}for(o.removeAttribute("pow");s=t(o,"*[pow]:not([pow] [pow])")[0];)l(s,p);for(let{name:e,value:t}of[...o.attributes])":"==e[0]?(o.removeAttribute(e),(t=n(t,p))&&o.setAttribute(e.slice(1),i(t,p.root==p.data))):(t=r(t,p))?o.setAttribute(e,t):o.removeAttribute(e);s=r(o.innerHTML,p),o instanceof HTMLTemplateElement?(o.insertAdjacentHTML("afterend",s),o.remove()):o.innerHTML=s},p=e=>{let r=e.innerHTML,n=[...e.attributes],o=`$pow_${Math.random().toString(36).slice(2)}`,a={apply:p=>{if(a.$pow)return console.warn("Binding already in progress");a.$pow=1,e.innerHTML=r,n.forEach((t=>e.setAttribute(t.name,t.value)));for(let r of t(e,"*[pow][stop]"))r.outerHTML=i(r.outerHTML);window[o]={};try{l(e,{id:o,path:"*root",data:p,root:p})}finally{delete a.$pow}return e.innerHTML=e.innerHTML.replace(/​/g,""),a.refresh=()=>a.apply(p),a},refresh:()=>{}};return a},s={apply:(e,t)=>p(e).apply(t),bind:p,_eval:(e,t)=>{let r=Object.entries(t||{}).filter((e=>isNaN(e[0])));return new Function(...r.map((e=>e[0])),`return ${e}`).call(t,...r.map((e=>e[1])))}};export default s;