/**
 * @license MIT
 * @author IFYates <https://github.com/ifyates/pow.js>
 * @description A very small and lightweight templating framework.
 * @version 3.2.0
 */
let e="pow",t="$data",r="$parent",n="$path",o="$root",a="array",l="else",i="template",s="function",f="innerHTML",c="outerHTML",p="replace",u=(e,t,r)=>e.setAttribute(t,r),$=(e,t)=>e.removeAttribute(t),d=(e,t)=>t?e:e[p](/({|p)({|ow)/g,"$1​$2​"),m=Math.random,w=(e,t)=>e.replaceWith(document.createRange().createContextualFragment(t)),y=(e,t)=>(e.content??e).querySelectorAll(t),g=(o,h,v,N)=>{let x=e=>d(e[p](/{{\s*(.*?)\s*}}/gs,((e,t)=>B(t)??"")),v),A=(e,t,r=o.nextElementSibling)=>(!e&&r?.attributes.pow&&$(r,l),t|!e&&!o.remove()),B=(e,t,r=E(h))=>{try{let n=b._eval(e,r);if(!t&typeof n==s){let e=m();return window[h.$id][e]=e=>n.call(e,r),h.$id+"["+e+"](this)"}return n}catch(t){console.warn("Interpolation failed",{[n]:h[n],expr:e},t)}},E=e=>({...e[t],...e,[r]:e[r]&&E(e[r])});for(let t of[...y(o,"*")].filter((t=>t.localName==e|t.tagName.startsWith("POW:"))))w(t,t[c][p](/^<pow(:[\w-]+)?/i,`<${i} ${e} ${i}="$1"`));for(let e of y(o,"*[pow][stop]"))w(e,d(e[c]));$(o,e);let M=0;for(let{name:e,value:s}of[...o.attributes]){if($(o,e),e==i&&s&&!A(N=document.getElementById(s))){let e={},t=null;for(let r of y(o,i))t??=r[f],e[r.id]=r[f];return t??=o[f],o[f]=N[f][p](/<param(?:\s+id=["']([^"']+)["'])?\s*\/?>/g,((r,n)=>n?e[n]||"":t)),g(o,{...h,$content:e})}if(N=()=>N=s?B(s):h[t],e==a){N=!N()|Array.isArray(N)?N:Object.entries(N).map((([e,t])=>({key:e,value:t})));for(let e=0;e<N?.length;++e){let l=o.cloneNode(1);o.parentNode.insertBefore(l,o),g(l,{...h,[n]:`${h[n]}.${s||a}[${e}]`,$index:e,$first:!e,$last:e>N.length-2,[t]:N[e],$array:N,[r]:h})}return A(N?.length,1)}if("data"==e)return A(null!=N())?0:g(o,{...h,[n]:h[n]+"."+s,[t]:N,[r]:h},v);if("if"==e|"ifnot"==e){if(A("if"==e!=!N()))return}else{if(":"==e[0])return N()&&u(o,e.slice(1),N),g(o,h);if(":"==e.at(-1))h={...h,[t]:{...h[t],[e.slice(0,-1)]:N()}};else{if(e==l)return o.remove();"transform"==e?M=B(s,1):(N=x(s))&&u(o,e,N)}}}for(;N=y(o,"[pow]:not([pow] [pow])")[0];)g(N,h);typeof M==s&&M(o,h),o[f]=x(o[f]),o.localName==i&&w(o,o[f])},h=e=>{let r=e[f],a=[...e.attributes],l="$pow_"+m().toString(36).slice(2),i={apply:s=>{if(i.$)return console.warn("Binding already in progress");i.$=1,e[f]=r,a.forEach((t=>u(e,t.name,t.value))),window[l]={};try{g(e,{$id:l,[n]:o,[t]:s,[o]:s},1)}finally{e[f]=e[f][p](/​/g,""),delete i.$}return i.refresh=()=>i.apply(s),i},refresh:()=>{}};return i},b={apply:(e,t)=>h(e).apply(t),bind:h,_eval:(e,r,n=Object.entries(r).filter((e=>isNaN(e[0]))))=>new Function(...n.map((e=>e[0])),"return "+e).call(r[t],...n.map((e=>e[1])))};export default b;