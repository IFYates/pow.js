/**
 * @license MIT
 * @author IFYates <https://github.com/ifyates/pow.js>
 * @description A very small and lightweight templating framework.
 * @version 1.0.2
 */
export default(()=>{function t(t){t.removeAttribute("pow");return(t.content??t).querySelector("*[pow]:not([pow] [pow])")}function e(t,e=["item","array","if","ifnot"]){for(let n of e){let e=t.getAttribute(n);if(null!=e)return t.removeAttribute(n),{attr:n,token:e}}return{}}let n=/\{\{\s*(.*?)\s*\}\}/gs;function r(t,e,r){for(;r=n.exec(t);){let i=o(r[1],e)??"";n.lastIndex=r.index+`${i}`.length,t=t.slice(0,r.index)+i+t.slice(r.index+r[0].length)}return t}function o(t,e,n=t){try{let r="*"==t[0]&&(n=t.slice(1))?e:e?.data;r=Object.entries(r||{}).filter((t=>isNaN(t[0])));let o=new Function(...r.map((t=>t[0])),`return ${n}`)(...r.map((t=>t[1])));if("function"==typeof o){let t=`_${Math.random().toString(36).slice(2)}`;return window.$pow$[t]=t=>o.call(t,e.data,e.root),`$pow$.${t}(this)`}return o}catch(n){console.warn("Interpolation failed",{"*path":e.path,token:t},n)}}function i(t,n){if(t?.attributes.pow){let{attr:r,token:o}=e(t,["else-if","else-ifnot","else"]);if(r&&n)return t.remove(),!0;r&&"else"!=r&&t.setAttribute(r.slice(5),o)}}function a(n,s){let{attr:f,token:l}=e(n),c=l?o(l,s):s.data;if("if"==f||"ifnot"==f){for(;i(n.nextElementSibling,"if"==f!=!c););if("if"==f==!c)return n.remove()}else if("item"==f&&l)s={...s,path:`${s.path}.${l}`,data:c,parent:s.data};else if("array"==f&&"object"==typeof c){let t=Array.isArray(c)?c:Object.entries(c).map((([t,e])=>({key:t,value:e})));for(let e=0;e<t.length;++e){let r=n.cloneNode(1);n.parentNode.insertBefore(r,n),a(r,{...s,path:`${s.path}${l?`.${l}`:""}[${e}]`,index:e,first:!e,last:e>t.length-2,data:t[e],parent:s})}return n.remove()}for(var p;p=t(n);)a(p,s);for(let{name:t,value:e}of n.attributes)n.setAttribute(t,r(e,s));let u=r(n.innerHTML,s);n instanceof HTMLTemplateElement?(n.insertAdjacentHTML("afterend",u),n.remove()):n.innerHTML=u}function s(t){let e=t.innerHTML,n=[...t.attributes],r={apply:o=>{if(r.$pow)return console.warn("Binding already in progress");r.$pow=1,window.$pow$={},t.innerHTML=e;for(let{name:e,value:r}of n)t.setAttribute(e,r);return a(t,{path:"*root",data:o,root:o}),delete r.$pow,r.refresh=()=>r.apply(o),r},refresh:()=>{}};return r}return{apply:(t,e)=>s(t).apply(e),bind:s}})();